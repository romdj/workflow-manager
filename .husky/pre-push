#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push validation (mirrors CI pipeline)..."
echo ""

# 1. Format check
echo "ğŸ“ [1/4] Checking code formatting..."
pnpm format:check || {
  echo "âŒ Format check failed. Run 'pnpm format' to fix."
  exit 1
}
echo "âœ… Format check passed"
echo ""

# 2. Lint
echo "ğŸ” [2/4] Running linters..."
pnpm lint || {
  echo "âŒ Lint failed. Run 'pnpm lint:fix' to auto-fix issues."
  exit 1
}
echo "âœ… Lint passed"
echo ""

# 3. Type check
echo "ğŸ”§ [3/4] Type checking..."
pnpm type-check || {
  echo "âŒ Type check failed. Fix TypeScript errors before pushing."
  exit 1
}
echo "âœ… Type check passed"
echo ""

# 4. Tests
echo "ğŸ§ª [4/4] Running tests..."
pnpm test || {
  echo "âŒ Tests failed. Fix failing tests before pushing."
  exit 1
}
echo "âœ… Tests passed"
echo ""

echo "âœ¨ All pre-push checks passed! Safe to push."
